<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>游戏详情</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/game-detail.css">
    <link rel="shortcut icon" href="images/icon.png" type="image/x-icon" />
</head>

<body>
<!--引入头部-->
<div id="header"></div>
    <!-- 详情 start -->   
    <div class="wrap">
        <div class="bread_box">
            <a href="/">首页</a>
            <span> &gt;</span>
            <a href="game_list.html?cid=1">游戏中心</a><span> &gt;</span>
            <a href="#">《漫威复联》首位黑人超级英雄黑豹出现 为瓦坎达而战</a>
        </div>
        <div class="prosum_box">
            <dl class="prosum_left">
                <dt>
                    <img alt="" class="big_img" src="images/pic07.png">
                </dt>
                <dd id="dd">
                    <a class="up_img up_img_disable"></a>
                    <a title="" class="little_img" data-bigpic="images/pic02.png">
                        <img src="images/pic02.png">
                    </a>
                    <a title="" class="little_img cur_img" data-bigpic="images/pic01.png">
                        <img src="images/pic01.png">
                    </a>
                    <a title="" class="little_img" data-bigpic="images/pic03.png">
                        <img src="images/pic03.png">
                    </a>
                    <a title="" class="little_img" data-bigpic="images/pic05.png" style="display:none;">
                        <img src="images/pic05.png">
                    </a>
                    <a title="" class="little_img" data-bigpic="images/pic06.png" style="display:none;">
                        <img src="images/pic06.png">
                    </a>
                    <a title="" class="little_img" data-bigpic="images/pic07.png" style="display:none;">
                        <img src="images/pic07.png">
                    </a>

                    <a class="down_img down_img_disable" style="margin-bottom: 0;"></a>
                </dd>
            </dl>
            <div class="prosum_right">
               <p class="pros_title" id="gname">《漫威复联》首位黑人超级英雄黑豹出现 为瓦坎达而战</p>
                <p class="hot">二月游戏日，限时打8折哦，走过不要错过哦~</p>
                <div class="pros_other">
                    <p  id="gameIntroduce">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;诸位漫威宇宙的粉丝《漫威复仇者》集结号已经吹响，不只是鹰眼师徒二人与黑豹，在游戏之中你还想看到其它什么超级英雄登场呢？让我们共同期待接下来的故事剧情，在超级英雄遍布的世界里匡扶正义！</p>
                </div>
                <div class="pros_price">
                    <p class="price">官方售价：<strong id="price">¥299.00</strong></p>
                    <p class="collect">
                        <a class="btn" id="favorite" onclick="addFavorite();"><i class="glyphicon glyphicon-heart-empty"></i>点击收藏游戏</a>

<!--                        <a  class="btn already" disabled="disabled"><i class="glyphicon glyphicon-heart-empty"></i>点击收藏</a>-->
                        <br><span id="favoriteCount">已被游民收藏<strong>100</strong>次！喜欢的话也加入收藏哟~</span>
                    </p>
                </div>        
            </div>
        </div>
        <div class="you_need_konw">
            <span>详细介绍</span>
            <div class="notice">
                <h2>瓦坎达黑豹，非洲黑土地之王</h2>
                <p>黑豹是漫威首位黑人超级英雄，影片中的瓦坎达外表贫困闭塞，实际拥有领先世界的高科技和大量稀有金属“振金”，也保留了古老的传统——角斗。电影《黑豹》讲述的是关于成长的故事，一个少年经历磨难终于羽化成蝶，
                    虽然是一贯的漫威超级英雄觉醒套路但是也在全球揽获了不错的票房 《黑豹》在漫威的诸多电影中较为年轻的一部，在经历了《美国队长3》内战的事件之后，黑豹回到家乡，那个与世隔绝、技术先进的非洲国家瓦坎达。多年前因为一块巨大的陨石坠落到瓦坎达，从而为这个国家带来了稀有的材料振金，这种有军事作用的金属矿藏吸引了众多外国匪徒前来掠夺，查拉在危急时刻就会化身超级英雄黑豹保护自己的国家。</br>
                黑豹算是一个定调鲜明的超级英雄，光芒万丈的少主被打入地狱，然后又重新站起来统领瓦坎达。黑豹扮演者的逝世难免会为接下来漫威的宇宙布局产生一定影响，而在最近以超级英雄为主题的游戏《漫威复仇者联盟》黑豹宣传片公布，黑豹归来！瓦坎达万岁！</p>

                <h2>黑豹归来，延续传奇英雄故事</h2>

                <p>水晶动力宣布，《漫威复仇者联盟》的全新扩展内容《黑豹，为瓦坎达而战》将在年内推出，届时英雄黑豹将作为新的免费追加角色登场。随后官方便公布了关于黑豹这款超级英雄的飒爽风姿，CG故事发生在瓦坎达的丛林之中，复仇者和黑豹共同联手抵御外敌的入侵。视频中展现出了瓦坎达连天的宏伟建筑，也为我们呈现出了振金宝库的神秘一角，当然黑豹最后时候的怒吼“复仇者，跟我来”更是宣告其王者归来，相信在加入了这款超级英雄之后黑豹与你将会擦出不一样的火花。</p>

                <h2>超级英雄登场，复联队伍集结完毕</h2>

                <p>在《漫威复仇者联盟》上线之后不到半年时间已经有两款免费DLC登场，女鹰眼与鹰眼的师徒组合在游戏中为抗击黑暗做出了巨大的贡献，复联队伍正重新集结自己的部队。在未来更多英雄也将逐渐融入到漫威游戏世界当中，毫无疑问一场属于超级英雄的盛宴已经开席！伴随着鹰眼到来的脚步，如今Steam商城迎来五折活动最后一日，抓紧这次机会购买你心仪的物品。同时黑豹等更多免费DLC内容也会今年稍后时间免费推出，请各位务必时刻关注官方B站，微博获取最新消息和资料。</p>
            </div>
        </div>
    </div>
    <!-- 详情 end -->

    <!--引入头部-->
    <div id="footer"></div>
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-3.3.1.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!--导入布局js，共享header和footer-->
    <script type="text/javascript" src="js/include.js"></script>
    <script src="js/getParameter.js"></script>
    <script>
    $(document).ready(function() {
        goImg();
        //自动播放
        // var timer = setInterval("auto_play()", 5000);
    });
    function goImg() {
        //焦点图效果
        //点击图片切换图片
        $('.little_img').on('mousemove', function() {
            $('.little_img').removeClass('cur_img');
            var big_pic = $(this).data('bigpic');
            $('.big_img').attr('src', big_pic);
            $(this).addClass('cur_img');
        });
        //上下切换
        var picindex = 0;
        var nextindex = 4;
        $('.down_img').on('click',function(){
            var num = $('.little_img').length;
            if((nextindex + 1) <= num){
                $('.little_img:eq('+picindex+')').hide();
                $('.little_img:eq('+nextindex+')').show();
                picindex = picindex + 1;
                nextindex = nextindex + 1;
            }
        });
        $('.up_img').on('click',function(){
            var num = $('.little_img').length;
            if(picindex > 0){
                $('.little_img:eq('+(nextindex-1)+')').hide();
                $('.little_img:eq('+(picindex-1)+')').show();
                picindex = picindex - 1;
                nextindex = nextindex - 1;
            }
        });
    }
    //自动轮播方法
    function auto_play() {
        var cur_index = $('.prosum_left dd').find('a.cur_img').index();
        cur_index = cur_index - 1;
        var num = $('.little_img').length;
        var max_index = 3;
        if ((num - 1) < 3) {
            max_index = num - 1;
        }
        if (cur_index < max_index) {
            var next_index = cur_index + 1;
            var big_pic = $('.little_img:eq(' + next_index + ')').data('bigpic');
            $('.little_img').removeClass('cur_img');
            $('.little_img:eq(' + next_index + ')').addClass('cur_img');
            $('.big_img').attr('src', big_pic);
        } else {
            var big_pic = $('.little_img:eq(0)').data('bigpic');
            $('.little_img').removeClass('cur_img');
            $('.little_img:eq(0)').addClass('cur_img');
            $('.big_img').attr('src', big_pic);
        }
    }
    $(function () {
        //获取gid
        let gid = getParameter("gid");
        //发送ajax请求
        $.get("game/findOne",{gid:gid},function (game) {
            $("#gname").html(game.gname);
            $("#price").html("￥"+game.price);
            $("#gameIntroduce").html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+game.gameIntroduce);
            $("#favoriteCount").html("已收藏"+game.count+"次");

            //图片展示
            let ddstr='<a class="up_img up_img_disable"></a>';
            //遍历routeImgList
            for (let i = 0; i < game.gameImgList.length; i++) {
                let astr;
                if(i>=3){
                    astr='<a title="" class="little_img" data-bigpic="'+game.gameImgList[i].bigPic+'" style="display:none;">\n' +
                        '        <img src="'+game.gameImgList[i].smallPic+'">\n' +
                        '      </a>';
                }else{
                    astr='<a title="" class="little_img" data-bigpic="'+game.gameImgList[i].bigPic+'">\n' +
                        '        <img src="'+game.gameImgList[i].smallPic+'">\n' +
                        '      </a>';
                }
                ddstr+=astr;
            }
            ddstr+='<a class="down_img down_img_disable" style="margin-bottom: 0;"></a>';
            $("#dd").html(ddstr);
            goImg();
        });
    });
    $(function () {
        //发送ajax请求，判断是否收藏过改路线
        let gid = getParameter("gid");
        $.get("game/isFavorite",{gid:gid},function (flag) {
            //判断是否收藏过
            if(flag){
                //收藏过
                $("#favorite").addClass("already");
                $("#favorite").attr("disabled",true);
                //删除按钮点击事件
                $("#favorite").removeAttr("onclick");
            }else{
                //没有收藏或未登录
            }
        })
    });
    function addFavorite() {
        let gid = getParameter("gid");
        //1.判断是否登录
        $.get("user/findOne",{},function (user) {
            if(user){
                //已经登录
                //添加收藏
                $.get("game/addFavorite",{gid:gid},function () {
                    location.reload();
                });
            }else{
                alert("您尚未登录,请登录");
                window.open("login.html");
            }
        })
    }
    </script>
</body>

</html>